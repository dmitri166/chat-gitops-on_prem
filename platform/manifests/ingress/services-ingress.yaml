apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: platform-services-ingress
  namespace: argocd
  annotations:
    traefik.ingress.kubernetes.io/router.tls: "false"
spec:
  ingressClassName: traefik
  rules:
  - host: argocd.localhost
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: argocd-server
            port:
              number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: monitoring-services-ingress
  namespace: monitoring
  annotations:
    traefik.ingress.kubernetes.io/router.tls: "false"
spec:
  ingressClassName: traefik
  rules:
  - host: grafana.localhost
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: monitoring-grafana
            port:
              number: 80
  - host: prometheus.localhost
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: monitoring-kube-prometheus-prometheus
            port:
              number: 9090
  - host: alertmanager.localhost
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: monitoring-kube-prometheus-alertmanager
            port:
              number: 9093
  - host: loki.localhost
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: monitoring-loki
            port:
              number: 3100
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: ghost-app-ingress-dev
  namespace: dev
  annotations:
    traefik.ingress.kubernetes.io/router.tls: "false"
    # OpenTelemetry annotations
    instrumentation.opentelemetry.io/inject-nodejs: "true"
spec:
  ingressClassName: traefik
  rules:
  - host: ghost-dev.localhost
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: ghost-dev-ghost
            port:
              number: 2368
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: ghost-app-ingress-staging
  namespace: staging
  annotations:
    traefik.ingress.kubernetes.io/router.tls: "false"
    # OpenTelemetry annotations
    instrumentation.opentelemetry.io/inject-nodejs: "true"
spec:
  ingressClassName: traefik
  rules:
  - host: ghost-staging.localhost
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: ghost-staging-ghost
            port:
              number: 2368
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: ghost-app-ingress-prod
  namespace: prod
  annotations:
    traefik.ingress.kubernetes.io/router.tls: "false"
    # OpenTelemetry annotations
    instrumentation.opentelemetry.io/inject-nodejs: "true"
    # Rate limiting for production
    traefik.ingress.kubernetes.io/router.middlewares: "prod-rate-limit@kubernetescrd"
spec:
  ingressClassName: traefik
  rules:
  - host: ghost-prod.localhost
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: ghost-prod-ghost
            port:
              number: 2368
